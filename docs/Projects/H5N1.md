---
layout: default
title: H5N1 Workflow
nav_order: 2
parent: Projects
description: "H5N1 Workflow"
---

# Layout Projects
{: .no_toc }

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---
# Initiate an R session using the Singularity image

* Open an interactive shell within Singularity containter and bind the relevant project directory.  `singularity shell -B /hpcdata/sg/sg_data/users/farmerr2/sandbox/temp/PAPER/:/var/workflow1 h5n1_image_180410.img`


* Initiate R session with `R` command. 

* Set working directory: `setwd("/var/workflow1")`.  

* Initialize required variables and load commonly used libraries. This script creates PROJECT_DIR variable pointing to the location of the workflow files.  
`source("SCRIPTS/0_initialize.r")`  

# Gene Expression PAXgene data processing

*We might not be using these processing steps anymore. Affymetrics platform is defunct.*

## Data post processing
* We found that two samples were switched. This is to correct it. 
```
source("SCRIPTS/MA/filtering_pax/switch.samples/switch.samples.call.r")
```

* Apply different filtering to samples and genes. The probesets mapped to genes. 
```
source("SCRIPTS/MA/filtering_pax/filtering.r")
```

* Calculate fold change from day 0. 
```
source("SCRIPTS/MA/calculate_d0_fc/calculate_d0_fc_pax.r")
```

# Baseline data analysis
* Preparing PBMC day 0 samples. 
```
source("SCRIPTS/MA/baseline_pbmc/d0_filter_pax.r")
```

* WGCNA clustering of PBMC samples 
```
source("SCRIPTS/MA/baseline_pbmc/d0_wgcna.r")
source("SCRIPTS/MA/baseline_pbmc/d0_wgcna_output.r")
```

* BTM enrichment analysis of data from PBMC samples
```
source("SCRIPTS/MA/baseline_pbmc/d0_wgcna_BTM_enrichment.r")
```

* Preparing whole blood (PAXgene) day 0 samples
```
source("SCRIPTS/MA/baseline_pax/d0_filter.r")
```

* WGCNA clustering of whole blood samples
```
source("SCRIPTS/MA/baseline_pax/d0_wgcna.r")
source("SCRIPTS/MA/baseline_pax/d0_wgcna_output.r")
```

* BTM enrichment analysis of data from whole blood samples
```
source("SCRIPTS/MA/baseline_pax/d0_wgcna_BTM_enrichment.r")
```
